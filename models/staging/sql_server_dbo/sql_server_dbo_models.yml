version: 2

models:

  # ─────────────────────────────────────────────────────────────
  # Base models: sólo tipado y filtrado mínimo
  # ─────────────────────────────────────────────────────────────

  - name: base_sql_server_dbo__events
    description: "Modelo base que filtra eventos inválidos y asegura tipos consistentes"
    columns:
      - name: event_id
        description: "ID natural del evento"
        tests:
          - not_null
          - unique
      - name: page_url_raw
        description: "URL donde ocurrió el evento"
      - name: event_type_raw
        description: "Tipo de evento"
      - name: user_id_nk
        description: "ID del usuario relacionado"
      - name: product_id_nk
        description: "ID del producto relacionado"
      - name: order_id_nk
        description: "ID del pedido relacionado"
      - name: created_at_raw
        description: "Timestamp original de creación"
      - name: _fivetran_deleted
        description: "Flag lógico de borrado"
      - name: synced_at_raw
        description: "Fecha de sincronización cruda"

  - name: base_sql_server_dbo__promos
    description: "Modelo base con promo dummy para evitar nulos"
    columns:
      - name: promo_id
        description: "ID natural de la promoción"
        tests:
          - not_null
          - unique
      - name: promo_name_raw
        description: "Nombre crudo de la promoción"
      - name: discount_raw
        description: "Porcentaje o monto de descuento crudo"
      - name: start_date_raw
        description: "Fecha de inicio de la promo cruda"
      - name: end_date_raw
        description: "Fecha fin de la promo cruda"
      - name: _fivetran_deleted
        description: "Flag lógico de borrado"
      - name: synced_at_raw
        description: "Fecha de sincronización cruda"

  - name: base_sql_server_dbo__orders
    description: "Modelo base que tipa y renombra columnas de orders"
    columns:
      - name: order_id
        description: "ID natural del pedido"
        tests:
          - not_null
          - unique
      - name: user_id
        description: "ID natural del usuario"
      - name: promo_id
        description: "ID natural de la promoción aplicada"
      - name: address_id
        description: "ID natural de la dirección asociada"
      - name: shipping_service
        description: "Servicio de envío crudo"
      - name: shipping_cost
        description: "Costo de envío crudo"
      - name: order_cost
        description: "Subtotal de pedido crudo"
      - name: order_total
        description: "Total de pedido crudo"
      - name: tracking_id
        description: "Código de seguimiento crudo"
      - name: order_status
        description: "Estado crudo del pedido"
      - name: created_at
        description: "Fecha cruda de creación"
      - name: estimated_delivery
        description: "Fecha estimada cruda"
      - name: delivered_at
        description: "Fecha de entrega cruda"
      - name: _fivetran_deleted
        description: "Flag lógico de borrado"
      - name: synced_at
        description: "Fecha de sincronización cruda"

  - name: base_sql_server_dbo__order_items
    description: "Modelo base que tipa y renombra columnas de order_items"
    columns:
      - name: order_id
        description: "ID natural del pedido"
      - name: product_id
        description: "ID natural del producto"
      - name: quantity
        description: "Cantidad cruda solicitada"
      - name: _fivetran_deleted
        description: "Flag lógico de borrado"
      - name: synced_at
        description: "Fecha de sincronización cruda"

  - name: base_sql_server_dbo__products
    description: "Modelo base que tipa y renombra columnas de products"
    columns:
      - name: product_id
        description: "ID natural del producto"
        tests:
          - not_null
          - unique
      - name: name
        description: "Nombre crudo del producto"
      - name: price
        description: "Precio unitario crudo"
      - name: inventory
        description: "Stock disponible crudo"
      - name: _fivetran_deleted
        description: "Flag lógico de borrado"
      - name: synced_at
        description: "Fecha de sincronización cruda"

  - name: base_sql_server_dbo__addresses
    description: "Modelo base que tipa y renombra columnas de addresses"
    columns:
      - name: address_id
        description: "ID natural de la dirección"
        tests:
          - not_null
          - unique
      - name: address
        description: "Dirección cruda"
      - name: state
        description: "Estado crudo"
      - name: country
        description: "País crudo"
      - name: zipcode
        description: "Código postal crudo"
      - name: _fivetran_deleted
        description: "Flag lógico de borrado"
      - name: synced_at
        description: "Fecha de sincronización cruda"

  - name: base_sql_server_dbo__users
    description: "Modelo base que tipa y renombra columnas de users"
    columns:
      - name: user_id
        description: "ID natural del usuario"
        tests:
          - not_null
          - unique
      - name: first_name
        description: "Nombre crudo"
      - name: last_name
        description: "Apellido crudo"
      - name: email
        description: "Correo crudo"
      - name: phone_number
        description: "Teléfono crudo"
      - name: total_orders
        description: "Total de pedidos crudo"
      - name: _fivetran_deleted
        description: "Flag lógico de borrado"
      - name: synced_at
        description: "Fecha de sincronización cruda"

  # ─────────────────────────────────────────────────────────────
  # Staging models: limpieza, surrogate keys, UTC, filtrado
  # ─────────────────────────────────────────────────────────────

      
